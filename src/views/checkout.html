<head>
    <title>Checkout</title>
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        alert('hello')
const stripe = Stripe('pk_test_51KJdkBSBAERtxvq0Nvh7E5lEQaOjWOgBmFBIcnu723EyQgXx7lngesM9Au2VBILH5Kl26wqOOw5dJgTIppqjGh1S00lXSEhdXV');
(async () => {
    const response = await fetch('pay');
    const client_secret = await response.json();
    const options = {
        clientSecret: client_secret,
        // Fully customizable with appearance API.
        appearance: {/*...*/},
      };
      
      // Set up Stripe.js and Elements to use in checkout form, passing the client secret obtained in step 2
      const elements = stripe.elements(options);
      
      // Create and mount the Payment Element
      const paymentElement = elements.create('payment');
      paymentElement.mount('#payment-element');
  })();
  const form = document.getElementById('payment-form');


    </script>

  </head>
  <form id="payment-form">
    <div id="payment-element">
      <!-- Elements will create form elements here -->
    </div>
    <button id="submit">Submit</button>
    <div id="error-message">
      <!-- Display error message to your customers here -->
    </div>
  </form>
  <script>
      form.addEventListener('submit', async (event) => {
  event.preventDefault();

  const {error} = await stripe.confirmPayment({
    //`Elements` instance that was used to create the Payment Element
    elements,
    confirmParams: {
      return_url: 'http://localhost:3080/payment/complete',
    },
  });

  if (!error) {
    const messageContainer = document.querySelector('#error-message');
    messageContainer.textContent = error.message;
  } else {
    // Your customer will be redirected to your `return_url`. For some payment
    // methods like iDEAL, your customer will be redirected to an intermediate
    // site first to authorize the payment, then redirected to the `return_url`.
    await fetch('/');
  }
});
  </script>